
Attaching package: ‘dplyr’

=== 1) LOADING MULTI-YEAR NFL DATA (2010-2022) ===

=== Aggregating Each Player's Season Stats ===

=== Creating Next-Season PPR Column (Truly Predictive) ===

Head of 'df_predict' dataset:
# A tibble: 6 × 16
  player_id  player_display_name position season passing_yards passing_tds
  <chr>      <chr>               <chr>     <int>         <dbl>       <int>
1 00-0000865 Charlie Batch       QB         2010           352           3
2 00-0000865 Charlie Batch       QB         2011           208           0
3 00-0002110 Mark Brunell        QB         2010           117           2
4 00-0003292 Kerry Collins       QB         2010          1823          14
5 00-0004161 Jake Delhomme       QB         2010           872           2
6 00-0004541 Donald Driver       WR         2010             0           0
# ℹ 10 more variables: interceptions <dbl>, carries <int>, rushing_yards <dbl>,
#   rushing_tds <int>, receptions <int>, receiving_yards <dbl>,
#   receiving_tds <int>, ppr_this_season <dbl>, next_season <dbl>,
#   ppr_next_season <dbl>

=== 2) DEFINING CROSS-VALIDATION OVER YEARS ===

=== 3) RUNNING YEAR-BASED CROSS-VALIDATION SPLITS ===
  -> FOLD w/ test_year = 2011  (Train size = 382 , Test size = 375 )
  -> FOLD w/ test_year = 2012  (Train size = 757 , Test size = 380 )
  -> FOLD w/ test_year = 2013  (Train size = 1137 , Test size = 370 )
  -> FOLD w/ test_year = 2014  (Train size = 1507 , Test size = 389 )
  -> FOLD w/ test_year = 2015  (Train size = 1896 , Test size = 385 )
  -> FOLD w/ test_year = 2016  (Train size = 2281 , Test size = 393 )
  -> FOLD w/ test_year = 2017  (Train size = 2674 , Test size = 379 )
  -> FOLD w/ test_year = 2018  (Train size = 3053 , Test size = 385 )
  -> FOLD w/ test_year = 2019  (Train size = 3438 , Test size = 420 )
  -> FOLD w/ test_year = 2020  (Train size = 3858 , Test size = 442 )
  -> FOLD w/ test_year = 2021  (Train size = 4300 , Test size = 439 )

=== CROSS-VALIDATION RESULTS (by test_year) ===
   test_year   mse_lm mse_lasso mse_ridge   mse_rf  mse_xgb best_model
1       2011 5082.074  5054.721  4663.655 4801.003 5830.453      ridge
2       2012 4737.667  4716.625  4678.486 5243.017 6073.457      ridge
3       2013 4851.875  4860.169  4880.723 5464.630 6474.860         lm
4       2014 5356.963  5350.552  5336.343 5551.890 6141.721      ridge
5       2015 4616.674  4636.609  4628.263 4999.115 5226.520         lm
6       2016 3865.367  3839.099  3815.683 3985.599 4508.811      ridge
7       2017 5089.517  5101.355  5116.576 5788.356 5896.499         lm
8       2018 4733.084  4750.141  4784.780 4952.233 5484.990         lm
9       2019 4823.287  4885.029  4932.663 4981.505 5557.166         lm
10      2020 4509.044  4512.213  4578.003 4858.467 5319.378         lm
11      2021 4018.003  4021.675  4066.800 4241.713 4811.544         lm

=== AVERAGE MSE ACROSS ALL FOLDS ===
        lm    lasso   ridge       rf      xgb
1 4698.505 4702.563 4680.18 4987.957 5575.036

Which model is best on average?
          [,1]
lm    4698.505
lasso 4702.563
ridge 4680.180
rf    4987.957
xgb   5575.036

Best Model Counts (lowest MSE per fold):

   lm ridge 
    7     4 

=== 4) FINAL TRAIN on [2010..2020], TEST on 2021 => Next Season (2022) ===
$mse_lm
[1] 4018.003

$mse_lasso
[1] 4021.675

$mse_ridge
[1] 4066.8

$mse_rf
[1] 4241.713

$mse_xgb
[1] 4811.544


Best model for 2021->2022 was: lm with MSE= 4018 


=== COMPLETE SUMMARY OF RESULTS ===
Year-based CV results:
   test_year   mse_lm mse_lasso mse_ridge   mse_rf  mse_xgb best_model
1       2011 5082.074  5054.721  4663.655 4801.003 5830.453      ridge
2       2012 4737.667  4716.625  4678.486 5243.017 6073.457      ridge
3       2013 4851.875  4860.169  4880.723 5464.630 6474.860         lm
4       2014 5356.963  5350.552  5336.343 5551.890 6141.721      ridge
5       2015 4616.674  4636.609  4628.263 4999.115 5226.520         lm
6       2016 3865.367  3839.099  3815.683 3985.599 4508.811      ridge
7       2017 5089.517  5101.355  5116.576 5788.356 5896.499         lm
8       2018 4733.084  4750.141  4784.780 4952.233 5484.990         lm
9       2019 4823.287  4885.029  4932.663 4981.505 5557.166         lm
10      2020 4509.044  4512.213  4578.003 4858.467 5319.378         lm
11      2021 4018.003  4021.675  4066.800 4241.713 4811.544         lm

Average MSE by model:
        lm    lasso   ridge       rf      xgb
1 4698.505 4702.563 4680.18 4987.957 5575.036

Single final test on 2021->2022:
$mse_lm
[1] 4018.003

$mse_lasso
[1] 4021.675

$mse_ridge
[1] 4066.8

$mse_rf
[1] 4241.713

$mse_xgb
[1] 4811.544


Best final model was: lm 

*** DONE ***
